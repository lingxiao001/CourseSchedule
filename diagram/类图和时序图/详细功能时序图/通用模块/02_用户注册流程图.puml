@startuml 用户注册流程图
title 用户注册流程图

start

:用户访问注册页面;
:填写注册信息;
:前端表单验证;

if (表单验证通过?) then (是)
    :发送注册请求;
    :服务端参数验证;
    
    if (参数验证通过?) then (是)
        :业务规则验证;
        
        if (业务验证通过?) then (是)
            :检查用户名唯一性;
            
            if (用户名可用?) then (是)
                :检查邮箱唯一性;
                
                if (邮箱可用?) then (是)
                    :密码加密;
                    :开始数据库事务;
                    :保存用户基本信息;
                    
                    if (角色为学生?) then (是)
                        :创建学生详细信息;
                    elseif (角色为教师?) then (是)
                        :创建教师详细信息;
                    endif
                    
                    :提交事务;
                    :生成激活码;
                    :发送激活邮件;
                    :显示注册成功页面;
                    :提示查收激活邮件;
                else (否)
                    :显示邮箱已被注册错误;
                endif
            else (否)
                :显示用户名已被使用错误;
            endif
        else (否)
            :显示业务验证错误;
        endif
    else (否)
        :显示参数错误;
    endif
else (否)
    :显示表单验证错误;
endif

stop

@enduml 