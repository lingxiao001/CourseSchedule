@startuml 学生提交选课申请流程图
title 学生提交选课申请流程图

start

:学生访问选课页面;
:身份验证;

if (身份验证通过?) then (是)
    :查询学生信息;
    :获取可选教学班列表;
    :查询学生已选课程;
    :过滤已选课程;
    :显示可选课程列表;
    
    :学生选择课程;
    :前端验证;
    
    if (前端验证通过?) then (否)
        :显示验证错误;
        stop
    else (是)
        :提交选课申请;
        :服务端身份验证;
        
        if (身份验证通过?) then (否)
            :返回认证失败;
            stop
        else (是)
            :查询教学班信息;
            
            if (教学班存在且未满?) then (否)
                :返回教学班不可选错误;
                stop
            else (是)
                :检查时间冲突;
                
                if (存在时间冲突?) then (是)
                    :返回时间冲突错误;
                    stop
                else (否)
                    :检查选课数量限制;
                    
                    if (超过选课上限?) then (是)
                        :返回选课数量超限错误;
                        stop
                    else (否)
                        :开始数据库事务;
                        :创建选课记录;
                        :增加教学班选课人数;
                        :提交事务;
                        :发送选课成功通知;
                        :返回选课成功结果;
                        :显示选课成功信息;
                        :刷新可选课程列表;
                    endif
                endif
            endif
        endif
    endif
else (否)
    :重定向到登录页面;
    stop
endif

stop

@enduml 