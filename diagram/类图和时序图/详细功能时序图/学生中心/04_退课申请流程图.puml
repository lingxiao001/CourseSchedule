@startuml 学生退课申请流程图
title 学生退课申请流程图

start

:学生在已选课程列表中点击退课;
:显示退课确认对话框;
:学生确认退课操作;
:身份验证;

if (身份验证通过?) then (是)
    :查询选课记录;
    
    if (选课记录存在?) then (是)
        :检查退课时间限制;
        
        if (在允许退课时间内?) then (是)
            :查询教学班信息;
            :开始数据库事务;
            :删除选课记录;
            :减少教学班选课人数;
            :提交事务;
            :记录退课日志;
            :发送退课通知;
            :显示退课成功信息;
            :刷新已选课程列表;
        else (否)
            :显示退课失败;
            note right: 超过退课期限
        endif
    else (否)
        :显示退课失败;
        note right: 未找到选课记录
    endif
else (否)
    :重定向到登录页面;
    stop
endif

stop

@enduml 